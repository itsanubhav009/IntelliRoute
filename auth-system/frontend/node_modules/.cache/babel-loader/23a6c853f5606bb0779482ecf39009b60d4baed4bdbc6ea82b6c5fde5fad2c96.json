{"ast":null,"code":"var _jsxFileName = \"/home/anubhav/project_6/auth-system/frontend/src/components/UserLocationMap.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$();\nimport React, { useEffect, useState, useContext, useRef } from 'react';\nimport { MapContainer, TileLayer, Marker, Popup, Polyline, useMap, useMapEvents } from 'react-leaflet';\nimport { LocationContext } from '../context/LocationContext';\nimport { AuthContext } from '../context/AuthContext';\nimport { ChatContext } from '../context/ChatContext';\nimport ChatDialog from './ChatDialog';\nimport NotificationsPanel from './NotificationsPanel';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport './UserLocationMap.css';\nimport NotificationButton from './NotificationButton';\n// Fix for default icons\nimport icon from 'leaflet/dist/images/marker-icon.png';\nimport iconShadow from 'leaflet/dist/images/marker-shadow.png';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faComments } from '@fortawesome/free-solid-svg-icons';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nlet DefaultIcon = L.icon({\n  iconUrl: icon,\n  shadowUrl: iconShadow,\n  iconSize: [25, 41],\n  iconAnchor: [12, 41]\n});\nL.Marker.prototype.options.icon = DefaultIcon;\n\n// Create custom icons\nconst createCustomIcon = color => {\n  return L.divIcon({\n    className: 'custom-div-icon',\n    html: `<div class=\"marker-pin\" style=\"background-color: ${color};\"></div>`,\n    iconSize: [30, 42],\n    iconAnchor: [15, 42]\n  });\n};\n\n// Helper to parse route data from PostGIS or OSRM\n// Enhanced parseRouteData function with better handling and debugging\nconst parseRouteData = routeData => {\n  // Debug information\n  console.log(`[MAP] Parsing route data: ${typeof routeData}`);\n  if (!routeData) {\n    console.log('[MAP] Route data is null or undefined');\n    return [];\n  }\n\n  // LINESTRING parsing\n  if (typeof routeData === 'string' && routeData.startsWith('LINESTRING')) {\n    try {\n      console.log(`[MAP] Parsing LINESTRING with length ${routeData.length}`);\n      // Extract coordinates from LINESTRING(lng lat, lng lat, ...)\n      const coordsStr = routeData.substring(routeData.indexOf('(') + 1, routeData.lastIndexOf(')'));\n      const points = coordsStr.split(',').map(pair => {\n        const [lng, lat] = pair.trim().split(' ').map(parseFloat);\n        // Return [lat, lng] for Leaflet\n        return [lat, lng];\n      });\n      console.log(`[MAP] Successfully parsed ${points.length} points from LINESTRING`);\n\n      // Verify we have valid points\n      if (points.length > 0) {\n        console.log(`[MAP] First point: [${points[0][0]}, ${points[0][1]}]`);\n        if (points.length > 1) {\n          const lastPoint = points[points.length - 1];\n          console.log(`[MAP] Last point: [${lastPoint[0]}, ${lastPoint[1]}]`);\n        }\n      }\n      return points;\n    } catch (e) {\n      console.error('[MAP] Error parsing LINESTRING:', e);\n      console.log('[MAP] Problematic route data:', routeData.substring(0, 100) + '...');\n      return [];\n    }\n  }\n\n  // If it's already an array, check if it's in the right format\n  if (Array.isArray(routeData)) {\n    console.log(`[MAP] Route data is already an array with ${routeData.length} points`);\n\n    // Check if the array contains [lat, lng] pairs\n    if (routeData.length > 0 && Array.isArray(routeData[0]) && routeData[0].length === 2) {\n      // Array seems to be in the correct format\n      return routeData;\n    } else {\n      console.warn('[MAP] Array is not in expected [lat, lng] format:', routeData[0]);\n      // Try to convert if possible\n      try {\n        return routeData.map(point => {\n          if (Array.isArray(point) && point.length >= 2) {\n            return [point[0], point[1]];\n          } else if (point && typeof point === 'object' && 'lat' in point && 'lng' in point) {\n            return [point.lat, point.lng];\n          }\n          return null;\n        }).filter(Boolean);\n      } catch (e) {\n        console.error('[MAP] Error converting array format:', e);\n        return [];\n      }\n    }\n  }\n\n  // If we get here, we couldn't parse the route data\n  console.warn('[MAP] Unrecognized route data format:', typeof routeData);\n  if (typeof routeData === 'object') {\n    console.warn('[MAP] Object keys:', Object.keys(routeData));\n  }\n  return [];\n};\n\n// Component to update map bounds based on users' positions and routes\nfunction MapBoundsUpdater({\n  users,\n  paths\n}) {\n  _s();\n  const map = useMap();\n  useEffect(() => {\n    if (!users.length && !paths.length) return;\n    try {\n      const points = [];\n\n      // Add user points\n      users.forEach(user => {\n        if (user.latitude && user.longitude) {\n          points.push([user.latitude, user.longitude]);\n        }\n      });\n\n      // Add path points (with better handling for complex routes)\n      paths.forEach(path => {\n        if (path.parsedRoute && Array.isArray(path.parsedRoute)) {\n          // Don't add every point - just add first, last, and some in between\n          // to avoid overloading the bounds calculation with too many points\n          const routePoints = path.parsedRoute;\n          if (routePoints.length > 0) {\n            points.push(routePoints[0]); // Add first point\n\n            if (routePoints.length > 10) {\n              // Add a few points in the middle for long routes\n              points.push(routePoints[Math.floor(routePoints.length / 3)]);\n              points.push(routePoints[Math.floor(routePoints.length * 2 / 3)]);\n            }\n            if (routePoints.length > 1) {\n              points.push(routePoints[routePoints.length - 1]); // Add last point\n            }\n          }\n        }\n      });\n      if (points.length > 0) {\n        const bounds = L.latLngBounds(points);\n        map.fitBounds(bounds, {\n          padding: [50, 50]\n        });\n      }\n    } catch (error) {\n      console.error('Error updating map bounds:', error);\n    }\n  }, [users, paths, map]);\n  return null;\n}\n\n// Component to handle map clicks for route creation\n_s(MapBoundsUpdater, \"IoceErwr5KVGS9kN4RQ1bOkYMAg=\", false, function () {\n  return [useMap];\n});\n_c = MapBoundsUpdater;\nfunction MapClickHandler({\n  routeMode,\n  selectedSource,\n  setSelectedSource,\n  createPath\n}) {\n  _s2();\n  useMapEvents({\n    click: e => {\n      if (!routeMode) return;\n      const {\n        lat,\n        lng\n      } = e.latlng;\n      if (!selectedSource) {\n        // Set source\n        setSelectedSource({\n          lat,\n          lng\n        });\n      } else {\n        // Set destination and create path\n        const destination = {\n          lat,\n          lng\n        };\n        createPath(selectedSource, destination);\n\n        // Reset route mode (this will be handled by parent component)\n      }\n    }\n  });\n  return null;\n}\n_s2(MapClickHandler, \"Ld/tk8Iz8AdZhC1l7acENaOEoCo=\", false, function () {\n  return [useMapEvents];\n});\n_c2 = MapClickHandler;\nconst UserLocationMap = () => {\n  _s3();\n  const {\n    liveUsers,\n    fetchLiveUsers,\n    livePaths,\n    fetchLivePaths,\n    createPath\n  } = useContext(LocationContext);\n  const {\n    user\n  } = useContext(AuthContext);\n  // Get all the chat context values we need including activeChats\n  const {\n    sendChatRequest,\n    notifications,\n    currentChat,\n    openChat,\n    activeChats,\n    fetchActiveChats\n  } = useContext(ChatContext);\n  const [usersWithLocation, setUsersWithLocation] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [lastUpdated, setLastUpdated] = useState(new Date());\n  const [pathsWithCoordinates, setPathsWithCoordinates] = useState([]);\n  const [routeMode, setRouteMode] = useState(false);\n  const [selectedSource, setSelectedSource] = useState(null);\n  const [showNotifications, setShowNotifications] = useState(false);\n  const mapRef = useRef(null);\n\n  // Chat request handler\n  const handleChatRequest = userId => {\n    if (userId === user.id) {\n      // Don't allow chatting with yourself\n      return;\n    }\n    sendChatRequest(userId).then(response => {\n      console.log('Chat request sent successfully:', response);\n    }).catch(error => {\n      console.error('Failed to send chat request:', error);\n    });\n  };\n\n  // Fetch active chats on component mount\n  useEffect(() => {\n    if (user && fetchActiveChats) {\n      fetchActiveChats();\n    }\n  }, [user, fetchActiveChats]);\n\n  // Updated useEffect to better process livePaths\n  useEffect(() => {\n    if (!livePaths) {\n      console.log('[MAP] livePaths is null or undefined');\n      setPathsWithCoordinates([]);\n      return;\n    }\n    console.log(`[MAP] Processing ${livePaths.length} paths from LocationContext`);\n    try {\n      // Process each path\n      const parsed = livePaths.map((path, index) => {\n        // Check if this path has a route property\n        if (!path.route) {\n          console.log(`[MAP] Path ${index} has no route property:`, path);\n          // Check if it has route_wkt instead\n          if (path.route_wkt) {\n            console.log(`[MAP] Path ${index} has route_wkt property instead`);\n            path.route = path.route_wkt;\n          } else {\n            console.log(`[MAP] Path ${index} has no route data at all`);\n            return null;\n          }\n        }\n        const parsedRoute = parseRouteData(path.route);\n\n        // Check if we successfully parsed the route\n        if (parsedRoute.length === 0) {\n          console.log(`[MAP] Path ${index} (${path.id}) could not be parsed`);\n          return null;\n        }\n        console.log(`[MAP] Path ${index} (${path.id}): Successfully parsed ${parsedRoute.length} points`);\n\n        // Return the path with parsed route\n        return {\n          ...path,\n          parsedRoute\n        };\n      }).filter(Boolean); // Remove null entries\n\n      console.log(`[MAP] Setting ${parsed.length} paths with valid coordinates`);\n      setPathsWithCoordinates(parsed);\n\n      // If we have paths but none with valid coordinates, log a warning\n      if (livePaths.length > 0 && parsed.length === 0) {\n        console.warn('[MAP] All paths failed to parse:', livePaths);\n      }\n    } catch (error) {\n      console.error('[MAP] Error processing paths:', error);\n      setPathsWithCoordinates([]);\n    }\n  }, [livePaths]);\n  const toggleRouteMode = () => {\n    setRouteMode(!routeMode);\n    if (routeMode) {\n      // If turning off, clear selected source\n      setSelectedSource(null);\n    }\n  };\n  const handleCreatePath = async (source, destination) => {\n    try {\n      console.log('[MAP] Creating path from', source, 'to', destination);\n\n      // Show loading state\n      setIsLoading(true);\n\n      // Create the path\n      const result = await createPath(source, destination);\n      console.log('[MAP] Path created successfully:', result);\n\n      // Force a refresh of path data\n      await fetchLivePaths();\n\n      // Set last updated time\n      setLastUpdated(new Date());\n\n      // Exit route creation mode\n      setRouteMode(false);\n      setSelectedSource(null);\n    } catch (error) {\n      console.error('[MAP] Error creating path:', error);\n      // Show error to user\n      alert(`Failed to create path: ${error.message}`);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const formatTime = date => {\n    if (!(date instanceof Date)) {\n      try {\n        date = new Date(date);\n      } catch (e) {\n        return 'Unknown';\n      }\n    }\n    return date.toLocaleTimeString();\n  };\n  if (isLoading && usersWithLocation.length === 0 && pathsWithCoordinates.length === 0) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"map-loading\",\n      children: \"Loading map...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 341,\n      columnNumber: 12\n    }, this);\n  }\n\n  // Calculate center point for map display or use a default\n  let centerLat = 0,\n    centerLng = 0;\n  if (usersWithLocation.length > 0) {\n    centerLat = usersWithLocation.reduce((sum, u) => sum + parseFloat(u.latitude || 0), 0) / usersWithLocation.length;\n    centerLng = usersWithLocation.reduce((sum, u) => sum + parseFloat(u.longitude || 0), 0) / usersWithLocation.length;\n  } else {\n    // Default to a central location if no users\n    centerLat = 0;\n    centerLng = 0;\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"map-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"map-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Live User Map\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 359,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"map-controls\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"notification-controls\",\n          children: [/*#__PURE__*/_jsxDEV(NotificationButton, {\n            notificationCount: notifications ? notifications.length : 0,\n            onClick: () => setShowNotifications(!showNotifications)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 362,\n            columnNumber: 11\n          }, this), showNotifications && /*#__PURE__*/_jsxDEV(NotificationsPanel, {\n            onClose: () => setShowNotifications(false)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 368,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 361,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: `route-button ${routeMode ? 'active' : ''}`,\n          onClick: toggleRouteMode,\n          children: routeMode ? 'Cancel Route' : 'Create Route'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 372,\n          columnNumber: 9\n        }, this), routeMode && !selectedSource && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"route-instructions\",\n          children: \"Click on map to set starting point\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 380,\n          columnNumber: 11\n        }, this), routeMode && selectedSource && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"route-instructions\",\n          children: \"Click on map to set destination\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 384,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"last-updated\",\n          children: [\"Last updated: \", formatTime(lastUpdated)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 387,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 360,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 358,\n      columnNumber: 6\n    }, this), /*#__PURE__*/_jsxDEV(MapContainer, {\n      center: [centerLat, centerLng],\n      zoom: 3,\n      style: {\n        height: '600px',\n        width: '100%'\n      },\n      ref: mapRef,\n      children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n        attribution: \"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors\",\n        url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 399,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(MapClickHandler, {\n        routeMode: routeMode,\n        selectedSource: selectedSource,\n        setSelectedSource: setSelectedSource,\n        createPath: handleCreatePath\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 405,\n        columnNumber: 9\n      }, this), usersWithLocation.map(u => /*#__PURE__*/_jsxDEV(Marker, {\n        position: [parseFloat(u.latitude), parseFloat(u.longitude)],\n        icon: createCustomIcon(u.id === (user === null || user === void 0 ? void 0 : user.id) ? '#4285F4' : '#FF5722'),\n        children: /*#__PURE__*/_jsxDEV(Popup, {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"user-popup\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              children: u.username\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 421,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"user-status\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"status-dot\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 423,\n                columnNumber: 19\n              }, this), \"Online\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 422,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"user-location\",\n              children: [\"Coordinates: \", parseFloat(u.latitude).toFixed(4), \", \", parseFloat(u.longitude).toFixed(4)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 426,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"user-last-active\",\n              children: [\"Last active: \", formatTime(u.last_active)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 429,\n              columnNumber: 17\n            }, this), u.id === (user === null || user === void 0 ? void 0 : user.id) ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"current-user-tag\",\n              children: \"This is you\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 433,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"chat-button-container\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"chat-request-button\",\n                onClick: () => handleChatRequest(u.id),\n                children: [\"Chat with \", u.username]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 436,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 435,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 420,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 419,\n          columnNumber: 13\n        }, this)\n      }, `user-${u.id}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 414,\n        columnNumber: 11\n      }, this)), routeMode && selectedSource && /*#__PURE__*/_jsxDEV(Marker, {\n        position: [selectedSource.lat, selectedSource.lng],\n        icon: createCustomIcon('#00C853'),\n        children: /*#__PURE__*/_jsxDEV(Popup, {\n          children: \"Starting point\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 455,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 451,\n        columnNumber: 11\n      }, this), pathsWithCoordinates.map((path, idx) => /*#__PURE__*/_jsxDEV(Polyline, {\n        positions: path.parsedRoute,\n        color: path.user_id === (user === null || user === void 0 ? void 0 : user.id) ? '#2196F3' : '#FF5722',\n        weight: 4,\n        opacity: 0.7,\n        children: /*#__PURE__*/_jsxDEV(Popup, {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"path-popup\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"Route Information\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 470,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"User:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 471,\n                columnNumber: 20\n              }, this), \" \", path.username || 'Unknown']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 471,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Created:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 472,\n                columnNumber: 20\n              }, this), \" \", formatTime(path.created_at)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 472,\n              columnNumber: 17\n            }, this), path.parsedRoute.length > 0 && /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"From:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 475,\n                  columnNumber: 24\n                }, this), \" \", path.parsedRoute[0][0].toFixed(4), \", \", path.parsedRoute[0][1].toFixed(4)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 475,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"To:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 476,\n                  columnNumber: 24\n                }, this), \" \", path.parsedRoute[path.parsedRoute.length - 1][0].toFixed(4), \", \", path.parsedRoute[path.parsedRoute.length - 1][1].toFixed(4)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 476,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Points:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 477,\n                  columnNumber: 24\n                }, this), \" \", path.parsedRoute.length]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 477,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 469,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 468,\n          columnNumber: 13\n        }, this)\n      }, `path-${path.id || idx}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 461,\n        columnNumber: 11\n      }, this)), /*#__PURE__*/_jsxDEV(MapBoundsUpdater, {\n        users: usersWithLocation,\n        paths: pathsWithCoordinates\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 486,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 393,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"map-legend\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Map Legend\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 493,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"legend-items\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"legend-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"legend-marker\",\n            style: {\n              backgroundColor: '#4285F4'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 496,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Your location\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 497,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 495,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"legend-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"legend-marker\",\n            style: {\n              backgroundColor: '#FF5722'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 500,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Other users\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 501,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 499,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"legend-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"legend-line\",\n            style: {\n              backgroundColor: '#2196F3'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 504,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Your paths\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 505,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 503,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"legend-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"legend-line\",\n            style: {\n              backgroundColor: '#FF5722'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 508,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Other users' paths\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 509,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 507,\n          columnNumber: 11\n        }, this), routeMode && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"legend-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"legend-marker\",\n            style: {\n              backgroundColor: '#00C853'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 513,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Selected starting point\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 514,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 512,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 494,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 492,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"map-info-panel\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Statistics\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 522,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"map-stats\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"stat-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Active Users:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 525,\n            columnNumber: 13\n          }, this), \" \", usersWithLocation.length]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 524,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"stat-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Active Paths:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 528,\n            columnNumber: 13\n          }, this), \" \", pathsWithCoordinates.length]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 527,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"stat-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Last Updated:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 531,\n            columnNumber: 13\n          }, this), \" \", formatTime(lastUpdated)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 530,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 523,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"active-chats\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n            icon: faComments\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 538,\n            columnNumber: 13\n          }, this), \" Active Chats\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 537,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chats-list\",\n          children: activeChats && activeChats.length > 0 ? activeChats.map(chat => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"chat-item\",\n            onClick: () => openChat(chat.id),\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"chat-user\",\n              children: chat.otherParticipants && chat.otherParticipants.length > 0 ? chat.otherParticipants[0].username : 'Unknown User'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 548,\n              columnNumber: 19\n            }, this), chat.unreadCount > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"unread-badge\",\n              children: chat.unreadCount\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 554,\n              columnNumber: 21\n            }, this)]\n          }, chat.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 543,\n            columnNumber: 17\n          }, this)) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"no-chats\",\n            children: \"No active chats\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 559,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 540,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 536,\n        columnNumber: 9\n      }, this), pathsWithCoordinates.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"recent-paths\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"Recent Paths\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 566,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"paths-list\",\n          children: pathsWithCoordinates.slice(0, 5).map((path, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"path-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"path-header\",\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: path.username || 'Unknown user'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 571,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: formatTime(path.created_at)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 572,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 570,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"path-details\",\n              children: path.parsedRoute.length > 0 && /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(\"small\", {\n                  children: [\"From: \", path.parsedRoute[0][0].toFixed(4), \", \", path.parsedRoute[0][1].toFixed(4)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 577,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n                  children: [\"To: \", path.parsedRoute[path.parsedRoute.length - 1][0].toFixed(4), \", \", path.parsedRoute[path.parsedRoute.length - 1][1].toFixed(4)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 580,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n                  children: [\"Route Points: \", path.parsedRoute.length]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 583,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 574,\n              columnNumber: 19\n            }, this)]\n          }, idx, true, {\n            fileName: _jsxFileName,\n            lineNumber: 569,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 567,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 565,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 521,\n      columnNumber: 7\n    }, this), currentChat && /*#__PURE__*/_jsxDEV(ChatDialog, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 597,\n      columnNumber: 23\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 357,\n    columnNumber: 5\n  }, this);\n};\n_s3(UserLocationMap, \"JBaW6+8eFledA4w1kA1PflTzmi4=\");\n_c3 = UserLocationMap;\nexport default UserLocationMap;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"MapBoundsUpdater\");\n$RefreshReg$(_c2, \"MapClickHandler\");\n$RefreshReg$(_c3, \"UserLocationMap\");","map":{"version":3,"names":["React","useEffect","useState","useContext","useRef","MapContainer","TileLayer","Marker","Popup","Polyline","useMap","useMapEvents","LocationContext","AuthContext","ChatContext","ChatDialog","NotificationsPanel","L","NotificationButton","icon","iconShadow","FontAwesomeIcon","faComments","jsxDEV","_jsxDEV","Fragment","_Fragment","DefaultIcon","iconUrl","shadowUrl","iconSize","iconAnchor","prototype","options","createCustomIcon","color","divIcon","className","html","parseRouteData","routeData","console","log","startsWith","length","coordsStr","substring","indexOf","lastIndexOf","points","split","map","pair","lng","lat","trim","parseFloat","lastPoint","e","error","Array","isArray","warn","point","filter","Boolean","Object","keys","MapBoundsUpdater","users","paths","_s","forEach","user","latitude","longitude","push","path","parsedRoute","routePoints","Math","floor","bounds","latLngBounds","fitBounds","padding","_c","MapClickHandler","routeMode","selectedSource","setSelectedSource","createPath","_s2","click","latlng","destination","_c2","UserLocationMap","_s3","liveUsers","fetchLiveUsers","livePaths","fetchLivePaths","sendChatRequest","notifications","currentChat","openChat","activeChats","fetchActiveChats","usersWithLocation","setUsersWithLocation","isLoading","setIsLoading","lastUpdated","setLastUpdated","Date","pathsWithCoordinates","setPathsWithCoordinates","setRouteMode","showNotifications","setShowNotifications","mapRef","handleChatRequest","userId","id","then","response","catch","parsed","index","route","route_wkt","toggleRouteMode","handleCreatePath","source","result","alert","message","formatTime","date","toLocaleTimeString","children","fileName","_jsxFileName","lineNumber","columnNumber","centerLat","centerLng","reduce","sum","u","notificationCount","onClick","onClose","center","zoom","style","height","width","ref","attribution","url","position","username","toFixed","last_active","idx","positions","user_id","weight","opacity","created_at","backgroundColor","chat","otherParticipants","unreadCount","slice","_c3","$RefreshReg$"],"sources":["/home/anubhav/project_6/auth-system/frontend/src/components/UserLocationMap.js"],"sourcesContent":["import React, { useEffect, useState, useContext, useRef } from 'react';\nimport { MapContainer, TileLayer, Marker, Popup, Polyline, useMap, useMapEvents } from 'react-leaflet';\nimport { LocationContext } from '../context/LocationContext';\nimport { AuthContext } from '../context/AuthContext';\nimport { ChatContext } from '../context/ChatContext';\nimport ChatDialog from './ChatDialog';\nimport NotificationsPanel from './NotificationsPanel';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport './UserLocationMap.css';\nimport NotificationButton from './NotificationButton';\n// Fix for default icons\nimport icon from 'leaflet/dist/images/marker-icon.png';\nimport iconShadow from 'leaflet/dist/images/marker-shadow.png';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faComments } from '@fortawesome/free-solid-svg-icons';\n\n\nlet DefaultIcon = L.icon({\n  iconUrl: icon,\n  shadowUrl: iconShadow,\n  iconSize: [25, 41],\n  iconAnchor: [12, 41]\n});\n\nL.Marker.prototype.options.icon = DefaultIcon;\n\n// Create custom icons\nconst createCustomIcon = (color) => {\n  return L.divIcon({\n    className: 'custom-div-icon',\n    html: `<div class=\"marker-pin\" style=\"background-color: ${color};\"></div>`,\n    iconSize: [30, 42],\n    iconAnchor: [15, 42]\n  });\n};\n\n// Helper to parse route data from PostGIS or OSRM\n// Enhanced parseRouteData function with better handling and debugging\nconst parseRouteData = (routeData) => {\n  // Debug information\n  console.log(`[MAP] Parsing route data: ${typeof routeData}`);\n  \n  if (!routeData) {\n    console.log('[MAP] Route data is null or undefined');\n    return [];\n  }\n  \n  // LINESTRING parsing\n  if (typeof routeData === 'string' && routeData.startsWith('LINESTRING')) {\n    try {\n      console.log(`[MAP] Parsing LINESTRING with length ${routeData.length}`);\n      // Extract coordinates from LINESTRING(lng lat, lng lat, ...)\n      const coordsStr = routeData.substring(routeData.indexOf('(') + 1, routeData.lastIndexOf(')'));\n      const points = coordsStr.split(',').map(pair => {\n        const [lng, lat] = pair.trim().split(' ').map(parseFloat);\n        // Return [lat, lng] for Leaflet\n        return [lat, lng]; \n      });\n      \n      console.log(`[MAP] Successfully parsed ${points.length} points from LINESTRING`);\n      \n      // Verify we have valid points\n      if (points.length > 0) {\n        console.log(`[MAP] First point: [${points[0][0]}, ${points[0][1]}]`);\n        if (points.length > 1) {\n          const lastPoint = points[points.length - 1];\n          console.log(`[MAP] Last point: [${lastPoint[0]}, ${lastPoint[1]}]`);\n        }\n      }\n      \n      return points;\n    } catch (e) {\n      console.error('[MAP] Error parsing LINESTRING:', e);\n      console.log('[MAP] Problematic route data:', routeData.substring(0, 100) + '...');\n      return [];\n    }\n  }\n  \n  // If it's already an array, check if it's in the right format\n  if (Array.isArray(routeData)) {\n    console.log(`[MAP] Route data is already an array with ${routeData.length} points`);\n    \n    // Check if the array contains [lat, lng] pairs\n    if (routeData.length > 0 && Array.isArray(routeData[0]) && routeData[0].length === 2) {\n      // Array seems to be in the correct format\n      return routeData;\n    } else {\n      console.warn('[MAP] Array is not in expected [lat, lng] format:', routeData[0]);\n      // Try to convert if possible\n      try {\n        return routeData.map(point => {\n          if (Array.isArray(point) && point.length >= 2) {\n            return [point[0], point[1]];\n          } else if (point && typeof point === 'object' && 'lat' in point && 'lng' in point) {\n            return [point.lat, point.lng];\n          }\n          return null;\n        }).filter(Boolean);\n      } catch (e) {\n        console.error('[MAP] Error converting array format:', e);\n        return [];\n      }\n    }\n  }\n  \n  // If we get here, we couldn't parse the route data\n  console.warn('[MAP] Unrecognized route data format:', typeof routeData);\n  if (typeof routeData === 'object') {\n    console.warn('[MAP] Object keys:', Object.keys(routeData));\n  }\n  return [];\n};\n\n// Component to update map bounds based on users' positions and routes\nfunction MapBoundsUpdater({ users, paths }) {\n  const map = useMap();\n  \n  useEffect(() => {\n    if (!users.length && !paths.length) return;\n    \n    try {\n      const points = [];\n      \n      // Add user points\n      users.forEach(user => {\n        if (user.latitude && user.longitude) {\n          points.push([user.latitude, user.longitude]);\n        }\n      });\n      \n      // Add path points (with better handling for complex routes)\n      paths.forEach(path => {\n        if (path.parsedRoute && Array.isArray(path.parsedRoute)) {\n          // Don't add every point - just add first, last, and some in between\n          // to avoid overloading the bounds calculation with too many points\n          const routePoints = path.parsedRoute;\n          if (routePoints.length > 0) {\n            points.push(routePoints[0]); // Add first point\n            \n            if (routePoints.length > 10) {\n              // Add a few points in the middle for long routes\n              points.push(routePoints[Math.floor(routePoints.length / 3)]);\n              points.push(routePoints[Math.floor(routePoints.length * 2 / 3)]);\n            }\n            \n            if (routePoints.length > 1) {\n              points.push(routePoints[routePoints.length - 1]); // Add last point\n            }\n          }\n        }\n      });\n      \n      if (points.length > 0) {\n        const bounds = L.latLngBounds(points);\n        map.fitBounds(bounds, { padding: [50, 50] });\n      }\n    } catch (error) {\n      console.error('Error updating map bounds:', error);\n    }\n  }, [users, paths, map]);\n  \n  return null;\n}\n\n// Component to handle map clicks for route creation\nfunction MapClickHandler({ routeMode, selectedSource, setSelectedSource, createPath }) {\n  useMapEvents({\n    click: (e) => {\n      if (!routeMode) return;\n      \n      const { lat, lng } = e.latlng;\n      \n      if (!selectedSource) {\n        // Set source\n        setSelectedSource({ lat, lng });\n      } else {\n        // Set destination and create path\n        const destination = { lat, lng };\n        createPath(selectedSource, destination);\n        \n        // Reset route mode (this will be handled by parent component)\n      }\n    }\n  });\n  \n  return null;\n}\n\nconst UserLocationMap = () => {\n  const { liveUsers, fetchLiveUsers, livePaths, fetchLivePaths, createPath } = useContext(LocationContext);\n  const { user } = useContext(AuthContext);\n  // Get all the chat context values we need including activeChats\n  const { \n    sendChatRequest, \n    notifications, \n    currentChat, \n    openChat,\n    activeChats,\n    fetchActiveChats\n  } = useContext(ChatContext);\n  \n  const [usersWithLocation, setUsersWithLocation] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [lastUpdated, setLastUpdated] = useState(new Date());\n  const [pathsWithCoordinates, setPathsWithCoordinates] = useState([]);\n  const [routeMode, setRouteMode] = useState(false);\n  const [selectedSource, setSelectedSource] = useState(null);\n  const [showNotifications, setShowNotifications] = useState(false);\n  const mapRef = useRef(null);\n\n  // Chat request handler\n  const handleChatRequest = (userId) => {\n    if (userId === user.id) {\n      // Don't allow chatting with yourself\n      return;\n    }\n    \n    sendChatRequest(userId)\n      .then((response) => {\n        console.log('Chat request sent successfully:', response);\n      })\n      .catch((error) => {\n        console.error('Failed to send chat request:', error);\n      });\n  };\n\n  // Fetch active chats on component mount\n  useEffect(() => {\n    if (user && fetchActiveChats) {\n      fetchActiveChats();\n    }\n  }, [user, fetchActiveChats]);\n\n// Updated useEffect to better process livePaths\nuseEffect(() => {\n  if (!livePaths) {\n    console.log('[MAP] livePaths is null or undefined');\n    setPathsWithCoordinates([]);\n    return;\n  }\n  \n  console.log(`[MAP] Processing ${livePaths.length} paths from LocationContext`);\n  \n  try {\n    // Process each path\n    const parsed = livePaths.map((path, index) => {\n      // Check if this path has a route property\n      if (!path.route) {\n        console.log(`[MAP] Path ${index} has no route property:`, path);\n        // Check if it has route_wkt instead\n        if (path.route_wkt) {\n          console.log(`[MAP] Path ${index} has route_wkt property instead`);\n          path.route = path.route_wkt;\n        } else {\n          console.log(`[MAP] Path ${index} has no route data at all`);\n          return null;\n        }\n      }\n      \n      const parsedRoute = parseRouteData(path.route);\n      \n      // Check if we successfully parsed the route\n      if (parsedRoute.length === 0) {\n        console.log(`[MAP] Path ${index} (${path.id}) could not be parsed`);\n        return null;\n      }\n      \n      console.log(`[MAP] Path ${index} (${path.id}): Successfully parsed ${parsedRoute.length} points`);\n      \n      // Return the path with parsed route\n      return {\n        ...path,\n        parsedRoute\n      };\n    }).filter(Boolean); // Remove null entries\n    \n    console.log(`[MAP] Setting ${parsed.length} paths with valid coordinates`);\n    setPathsWithCoordinates(parsed);\n    \n    // If we have paths but none with valid coordinates, log a warning\n    if (livePaths.length > 0 && parsed.length === 0) {\n      console.warn('[MAP] All paths failed to parse:', livePaths);\n    }\n  } catch (error) {\n    console.error('[MAP] Error processing paths:', error);\n    setPathsWithCoordinates([]);\n  }\n}, [livePaths]);\n\n  const toggleRouteMode = () => {\n    setRouteMode(!routeMode);\n    if (routeMode) {\n      // If turning off, clear selected source\n      setSelectedSource(null);\n    }\n  };\n\n  const handleCreatePath = async (source, destination) => {\n    try {\n      console.log('[MAP] Creating path from', source, 'to', destination);\n      \n      // Show loading state\n      setIsLoading(true);\n      \n      // Create the path\n      const result = await createPath(source, destination);\n      \n      console.log('[MAP] Path created successfully:', result);\n      \n      // Force a refresh of path data\n      await fetchLivePaths();\n      \n      // Set last updated time\n      setLastUpdated(new Date());\n      \n      // Exit route creation mode\n      setRouteMode(false);\n      setSelectedSource(null);\n    } catch (error) {\n      console.error('[MAP] Error creating path:', error);\n      // Show error to user\n      alert(`Failed to create path: ${error.message}`);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const formatTime = (date) => {\n    if (!(date instanceof Date)) {\n      try {\n        date = new Date(date);\n      } catch (e) {\n        return 'Unknown';\n      }\n    }\n    return date.toLocaleTimeString();\n  };\n\n  if (isLoading && usersWithLocation.length === 0 && pathsWithCoordinates.length === 0) {\n    return <div className=\"map-loading\">Loading map...</div>;\n  }\n\n  // Calculate center point for map display or use a default\n  let centerLat = 0, centerLng = 0;\n  \n  if (usersWithLocation.length > 0) {\n    centerLat = usersWithLocation.reduce((sum, u) => sum + parseFloat(u.latitude || 0), 0) / usersWithLocation.length;\n    centerLng = usersWithLocation.reduce((sum, u) => sum + parseFloat(u.longitude || 0), 0) / usersWithLocation.length;\n  } else {\n    // Default to a central location if no users\n    centerLat = 0;\n    centerLng = 0;\n  }\n\n  return (\n    <div className=\"map-container\">\n     <div className=\"map-header\">\n      <h3>Live User Map</h3>\n      <div className=\"map-controls\">\n        <div className=\"notification-controls\">\n          <NotificationButton \n            notificationCount={notifications ? notifications.length : 0}\n            onClick={() => setShowNotifications(!showNotifications)}\n          />\n          \n          {showNotifications && (\n            <NotificationsPanel onClose={() => setShowNotifications(false)} />\n          )}\n        </div>\n        \n        <button \n          className={`route-button ${routeMode ? 'active' : ''}`} \n          onClick={toggleRouteMode}\n        >\n          {routeMode ? 'Cancel Route' : 'Create Route'}\n        </button>\n        \n        {routeMode && !selectedSource && (\n          <div className=\"route-instructions\">Click on map to set starting point</div>\n        )}\n        \n        {routeMode && selectedSource && (\n          <div className=\"route-instructions\">Click on map to set destination</div>\n        )}\n        \n        <span className=\"last-updated\">\n          Last updated: {formatTime(lastUpdated)}\n        </span>\n      </div>\n    </div>\n      \n      <MapContainer \n        center={[centerLat, centerLng]} \n        zoom={3} \n        style={{ height: '600px', width: '100%' }}\n        ref={mapRef}\n      >\n        <TileLayer\n          attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n        />\n        \n        {/* Map click handler for route creation */}\n        <MapClickHandler \n          routeMode={routeMode} \n          selectedSource={selectedSource} \n          setSelectedSource={setSelectedSource} \n          createPath={handleCreatePath}\n        />\n        \n        {/* Display user markers */}\n        {usersWithLocation.map(u => (\n          <Marker \n            key={`user-${u.id}`} \n            position={[parseFloat(u.latitude), parseFloat(u.longitude)]}\n            icon={createCustomIcon(u.id === user?.id ? '#4285F4' : '#FF5722')}\n          >\n            <Popup>\n              <div className=\"user-popup\">\n                <h3>{u.username}</h3>\n                <div className=\"user-status\">\n                  <span className=\"status-dot\"></span>\n                  Online\n                </div>\n                <div className=\"user-location\">\n                  Coordinates: {parseFloat(u.latitude).toFixed(4)}, {parseFloat(u.longitude).toFixed(4)}\n                </div>\n                <div className=\"user-last-active\">\n                  Last active: {formatTime(u.last_active)}\n                </div>\n                {u.id === user?.id ? (\n                  <div className=\"current-user-tag\">This is you</div>\n                ) : (\n                  <div className=\"chat-button-container\">\n                    <button \n                      className=\"chat-request-button\"\n                      onClick={() => handleChatRequest(u.id)}\n                    >\n                      Chat with {u.username}\n                    </button>\n                  </div>\n                )}\n              </div>\n            </Popup>\n          </Marker>\n        ))}\n\n        {/* Display route source marker if in route mode */}\n        {routeMode && selectedSource && (\n          <Marker \n            position={[selectedSource.lat, selectedSource.lng]}\n            icon={createCustomIcon('#00C853')}\n          >\n            <Popup>Starting point</Popup>\n          </Marker>\n        )}\n        \n        {/* Display paths as polylines */}\n        {pathsWithCoordinates.map((path, idx) => (\n          <Polyline \n            key={`path-${path.id || idx}`} \n            positions={path.parsedRoute} \n            color={path.user_id === user?.id ? '#2196F3' : '#FF5722'} \n            weight={4}\n            opacity={0.7}\n          >\n            <Popup>\n              <div className=\"path-popup\">\n                <h4>Route Information</h4>\n                <p><strong>User:</strong> {path.username || 'Unknown'}</p>\n                <p><strong>Created:</strong> {formatTime(path.created_at)}</p>\n                {path.parsedRoute.length > 0 && (\n                  <>\n                    <p><strong>From:</strong> {path.parsedRoute[0][0].toFixed(4)}, {path.parsedRoute[0][1].toFixed(4)}</p>\n                    <p><strong>To:</strong> {path.parsedRoute[path.parsedRoute.length-1][0].toFixed(4)}, {path.parsedRoute[path.parsedRoute.length-1][1].toFixed(4)}</p>\n                    <p><strong>Points:</strong> {path.parsedRoute.length}</p>\n                  </>\n                )}\n              </div>\n            </Popup>\n          </Polyline>\n        ))}\n\n        {/* Map bounds updater component */}\n        <MapBoundsUpdater \n          users={usersWithLocation} \n          paths={pathsWithCoordinates} \n        />\n      </MapContainer>\n      \n      <div className=\"map-legend\">\n        <h4>Map Legend</h4>\n        <div className=\"legend-items\">\n          <div className=\"legend-item\">\n            <div className=\"legend-marker\" style={{ backgroundColor: '#4285F4' }}></div>\n            <span>Your location</span>\n          </div>\n          <div className=\"legend-item\">\n            <div className=\"legend-marker\" style={{ backgroundColor: '#FF5722' }}></div>\n            <span>Other users</span>\n          </div>\n          <div className=\"legend-item\">\n            <div className=\"legend-line\" style={{ backgroundColor: '#2196F3' }}></div>\n            <span>Your paths</span>\n          </div>\n          <div className=\"legend-item\">\n            <div className=\"legend-line\" style={{ backgroundColor: '#FF5722' }}></div>\n            <span>Other users' paths</span>\n          </div>\n          {routeMode && (\n            <div className=\"legend-item\">\n              <div className=\"legend-marker\" style={{ backgroundColor: '#00C853' }}></div>\n              <span>Selected starting point</span>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Display path information and active chats panel */}\n      <div className=\"map-info-panel\">\n        <h4>Statistics</h4>\n        <div className=\"map-stats\">\n          <div className=\"stat-item\">\n            <strong>Active Users:</strong> {usersWithLocation.length}\n          </div>\n          <div className=\"stat-item\">\n            <strong>Active Paths:</strong> {pathsWithCoordinates.length}\n          </div>\n          <div className=\"stat-item\">\n            <strong>Last Updated:</strong> {formatTime(lastUpdated)}\n          </div>\n        </div>\n        \n        {/* New Active Chats Panel */}\n        <div className=\"active-chats\">\n          <h4>\n            <FontAwesomeIcon icon={faComments} /> Active Chats\n          </h4>\n          <div className=\"chats-list\">\n            {activeChats && activeChats.length > 0 ? (\n              activeChats.map(chat => (\n                <div \n                  key={chat.id} \n                  className=\"chat-item\"\n                  onClick={() => openChat(chat.id)}\n                >\n                  <div className=\"chat-user\">\n                    {chat.otherParticipants && chat.otherParticipants.length > 0 \n                      ? chat.otherParticipants[0].username \n                      : 'Unknown User'}\n                  </div>\n                  {chat.unreadCount > 0 && (\n                    <span className=\"unread-badge\">{chat.unreadCount}</span>\n                  )}\n                </div>\n              ))\n            ) : (\n              <div className=\"no-chats\">No active chats</div>\n            )}\n          </div>\n        </div>\n        \n        {pathsWithCoordinates.length > 0 && (\n          <div className=\"recent-paths\">\n            <h4>Recent Paths</h4>\n            <div className=\"paths-list\">\n              {pathsWithCoordinates.slice(0, 5).map((path, idx) => (\n                <div key={idx} className=\"path-item\">\n                  <div className=\"path-header\">\n                    <strong>{path.username || 'Unknown user'}</strong>\n                    <span>{formatTime(path.created_at)}</span>\n                  </div>\n                  <div className=\"path-details\">\n                    {path.parsedRoute.length > 0 && (\n                      <>\n                        <small>\n                          From: {path.parsedRoute[0][0].toFixed(4)}, {path.parsedRoute[0][1].toFixed(4)}\n                        </small>\n                        <small>\n                          To: {path.parsedRoute[path.parsedRoute.length-1][0].toFixed(4)}, {path.parsedRoute[path.parsedRoute.length-1][1].toFixed(4)}\n                        </small>\n                        <small>\n                          Route Points: {path.parsedRoute.length}\n                        </small>\n                      </>\n                    )}\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n      </div>\n      \n      {/* Chat dialog */}\n      {currentChat && <ChatDialog />}\n    </div>\n  );\n};\n\nexport default UserLocationMap;"],"mappings":";;;;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,EAAEC,UAAU,EAAEC,MAAM,QAAQ,OAAO;AACtE,SAASC,YAAY,EAAEC,SAAS,EAAEC,MAAM,EAAEC,KAAK,EAAEC,QAAQ,EAAEC,MAAM,EAAEC,YAAY,QAAQ,eAAe;AACtG,SAASC,eAAe,QAAQ,4BAA4B;AAC5D,SAASC,WAAW,QAAQ,wBAAwB;AACpD,SAASC,WAAW,QAAQ,wBAAwB;AACpD,OAAOC,UAAU,MAAM,cAAc;AACrC,OAAOC,kBAAkB,MAAM,sBAAsB;AACrD,OAAOC,CAAC,MAAM,SAAS;AACvB,OAAO,0BAA0B;AACjC,OAAO,uBAAuB;AAC9B,OAAOC,kBAAkB,MAAM,sBAAsB;AACrD;AACA,OAAOC,IAAI,MAAM,qCAAqC;AACtD,OAAOC,UAAU,MAAM,uCAAuC;AAC9D,SAASC,eAAe,QAAQ,gCAAgC;AAChE,SAASC,UAAU,QAAQ,mCAAmC;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAG/D,IAAIC,WAAW,GAAGV,CAAC,CAACE,IAAI,CAAC;EACvBS,OAAO,EAAET,IAAI;EACbU,SAAS,EAAET,UAAU;EACrBU,QAAQ,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;EAClBC,UAAU,EAAE,CAAC,EAAE,EAAE,EAAE;AACrB,CAAC,CAAC;AAEFd,CAAC,CAACV,MAAM,CAACyB,SAAS,CAACC,OAAO,CAACd,IAAI,GAAGQ,WAAW;;AAE7C;AACA,MAAMO,gBAAgB,GAAIC,KAAK,IAAK;EAClC,OAAOlB,CAAC,CAACmB,OAAO,CAAC;IACfC,SAAS,EAAE,iBAAiB;IAC5BC,IAAI,EAAE,oDAAoDH,KAAK,WAAW;IAC1EL,QAAQ,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;IAClBC,UAAU,EAAE,CAAC,EAAE,EAAE,EAAE;EACrB,CAAC,CAAC;AACJ,CAAC;;AAED;AACA;AACA,MAAMQ,cAAc,GAAIC,SAAS,IAAK;EACpC;EACAC,OAAO,CAACC,GAAG,CAAC,6BAA6B,OAAOF,SAAS,EAAE,CAAC;EAE5D,IAAI,CAACA,SAAS,EAAE;IACdC,OAAO,CAACC,GAAG,CAAC,uCAAuC,CAAC;IACpD,OAAO,EAAE;EACX;;EAEA;EACA,IAAI,OAAOF,SAAS,KAAK,QAAQ,IAAIA,SAAS,CAACG,UAAU,CAAC,YAAY,CAAC,EAAE;IACvE,IAAI;MACFF,OAAO,CAACC,GAAG,CAAC,wCAAwCF,SAAS,CAACI,MAAM,EAAE,CAAC;MACvE;MACA,MAAMC,SAAS,GAAGL,SAAS,CAACM,SAAS,CAACN,SAAS,CAACO,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,EAAEP,SAAS,CAACQ,WAAW,CAAC,GAAG,CAAC,CAAC;MAC7F,MAAMC,MAAM,GAAGJ,SAAS,CAACK,KAAK,CAAC,GAAG,CAAC,CAACC,GAAG,CAACC,IAAI,IAAI;QAC9C,MAAM,CAACC,GAAG,EAAEC,GAAG,CAAC,GAAGF,IAAI,CAACG,IAAI,CAAC,CAAC,CAACL,KAAK,CAAC,GAAG,CAAC,CAACC,GAAG,CAACK,UAAU,CAAC;QACzD;QACA,OAAO,CAACF,GAAG,EAAED,GAAG,CAAC;MACnB,CAAC,CAAC;MAEFZ,OAAO,CAACC,GAAG,CAAC,6BAA6BO,MAAM,CAACL,MAAM,yBAAyB,CAAC;;MAEhF;MACA,IAAIK,MAAM,CAACL,MAAM,GAAG,CAAC,EAAE;QACrBH,OAAO,CAACC,GAAG,CAAC,uBAAuBO,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAKA,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC;QACpE,IAAIA,MAAM,CAACL,MAAM,GAAG,CAAC,EAAE;UACrB,MAAMa,SAAS,GAAGR,MAAM,CAACA,MAAM,CAACL,MAAM,GAAG,CAAC,CAAC;UAC3CH,OAAO,CAACC,GAAG,CAAC,sBAAsBe,SAAS,CAAC,CAAC,CAAC,KAAKA,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC;QACrE;MACF;MAEA,OAAOR,MAAM;IACf,CAAC,CAAC,OAAOS,CAAC,EAAE;MACVjB,OAAO,CAACkB,KAAK,CAAC,iCAAiC,EAAED,CAAC,CAAC;MACnDjB,OAAO,CAACC,GAAG,CAAC,+BAA+B,EAAEF,SAAS,CAACM,SAAS,CAAC,CAAC,EAAE,GAAG,CAAC,GAAG,KAAK,CAAC;MACjF,OAAO,EAAE;IACX;EACF;;EAEA;EACA,IAAIc,KAAK,CAACC,OAAO,CAACrB,SAAS,CAAC,EAAE;IAC5BC,OAAO,CAACC,GAAG,CAAC,6CAA6CF,SAAS,CAACI,MAAM,SAAS,CAAC;;IAEnF;IACA,IAAIJ,SAAS,CAACI,MAAM,GAAG,CAAC,IAAIgB,KAAK,CAACC,OAAO,CAACrB,SAAS,CAAC,CAAC,CAAC,CAAC,IAAIA,SAAS,CAAC,CAAC,CAAC,CAACI,MAAM,KAAK,CAAC,EAAE;MACpF;MACA,OAAOJ,SAAS;IAClB,CAAC,MAAM;MACLC,OAAO,CAACqB,IAAI,CAAC,mDAAmD,EAAEtB,SAAS,CAAC,CAAC,CAAC,CAAC;MAC/E;MACA,IAAI;QACF,OAAOA,SAAS,CAACW,GAAG,CAACY,KAAK,IAAI;UAC5B,IAAIH,KAAK,CAACC,OAAO,CAACE,KAAK,CAAC,IAAIA,KAAK,CAACnB,MAAM,IAAI,CAAC,EAAE;YAC7C,OAAO,CAACmB,KAAK,CAAC,CAAC,CAAC,EAAEA,KAAK,CAAC,CAAC,CAAC,CAAC;UAC7B,CAAC,MAAM,IAAIA,KAAK,IAAI,OAAOA,KAAK,KAAK,QAAQ,IAAI,KAAK,IAAIA,KAAK,IAAI,KAAK,IAAIA,KAAK,EAAE;YACjF,OAAO,CAACA,KAAK,CAACT,GAAG,EAAES,KAAK,CAACV,GAAG,CAAC;UAC/B;UACA,OAAO,IAAI;QACb,CAAC,CAAC,CAACW,MAAM,CAACC,OAAO,CAAC;MACpB,CAAC,CAAC,OAAOP,CAAC,EAAE;QACVjB,OAAO,CAACkB,KAAK,CAAC,sCAAsC,EAAED,CAAC,CAAC;QACxD,OAAO,EAAE;MACX;IACF;EACF;;EAEA;EACAjB,OAAO,CAACqB,IAAI,CAAC,uCAAuC,EAAE,OAAOtB,SAAS,CAAC;EACvE,IAAI,OAAOA,SAAS,KAAK,QAAQ,EAAE;IACjCC,OAAO,CAACqB,IAAI,CAAC,oBAAoB,EAAEI,MAAM,CAACC,IAAI,CAAC3B,SAAS,CAAC,CAAC;EAC5D;EACA,OAAO,EAAE;AACX,CAAC;;AAED;AACA,SAAS4B,gBAAgBA,CAAC;EAAEC,KAAK;EAAEC;AAAM,CAAC,EAAE;EAAAC,EAAA;EAC1C,MAAMpB,GAAG,GAAGzC,MAAM,CAAC,CAAC;EAEpBT,SAAS,CAAC,MAAM;IACd,IAAI,CAACoE,KAAK,CAACzB,MAAM,IAAI,CAAC0B,KAAK,CAAC1B,MAAM,EAAE;IAEpC,IAAI;MACF,MAAMK,MAAM,GAAG,EAAE;;MAEjB;MACAoB,KAAK,CAACG,OAAO,CAACC,IAAI,IAAI;QACpB,IAAIA,IAAI,CAACC,QAAQ,IAAID,IAAI,CAACE,SAAS,EAAE;UACnC1B,MAAM,CAAC2B,IAAI,CAAC,CAACH,IAAI,CAACC,QAAQ,EAAED,IAAI,CAACE,SAAS,CAAC,CAAC;QAC9C;MACF,CAAC,CAAC;;MAEF;MACAL,KAAK,CAACE,OAAO,CAACK,IAAI,IAAI;QACpB,IAAIA,IAAI,CAACC,WAAW,IAAIlB,KAAK,CAACC,OAAO,CAACgB,IAAI,CAACC,WAAW,CAAC,EAAE;UACvD;UACA;UACA,MAAMC,WAAW,GAAGF,IAAI,CAACC,WAAW;UACpC,IAAIC,WAAW,CAACnC,MAAM,GAAG,CAAC,EAAE;YAC1BK,MAAM,CAAC2B,IAAI,CAACG,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;;YAE7B,IAAIA,WAAW,CAACnC,MAAM,GAAG,EAAE,EAAE;cAC3B;cACAK,MAAM,CAAC2B,IAAI,CAACG,WAAW,CAACC,IAAI,CAACC,KAAK,CAACF,WAAW,CAACnC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;cAC5DK,MAAM,CAAC2B,IAAI,CAACG,WAAW,CAACC,IAAI,CAACC,KAAK,CAACF,WAAW,CAACnC,MAAM,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;YAClE;YAEA,IAAImC,WAAW,CAACnC,MAAM,GAAG,CAAC,EAAE;cAC1BK,MAAM,CAAC2B,IAAI,CAACG,WAAW,CAACA,WAAW,CAACnC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;YACpD;UACF;QACF;MACF,CAAC,CAAC;MAEF,IAAIK,MAAM,CAACL,MAAM,GAAG,CAAC,EAAE;QACrB,MAAMsC,MAAM,GAAGjE,CAAC,CAACkE,YAAY,CAAClC,MAAM,CAAC;QACrCE,GAAG,CAACiC,SAAS,CAACF,MAAM,EAAE;UAAEG,OAAO,EAAE,CAAC,EAAE,EAAE,EAAE;QAAE,CAAC,CAAC;MAC9C;IACF,CAAC,CAAC,OAAO1B,KAAK,EAAE;MACdlB,OAAO,CAACkB,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;IACpD;EACF,CAAC,EAAE,CAACU,KAAK,EAAEC,KAAK,EAAEnB,GAAG,CAAC,CAAC;EAEvB,OAAO,IAAI;AACb;;AAEA;AAAAoB,EAAA,CAlDSH,gBAAgB;EAAA,QACX1D,MAAM;AAAA;AAAA4E,EAAA,GADXlB,gBAAgB;AAmDzB,SAASmB,eAAeA,CAAC;EAAEC,SAAS;EAAEC,cAAc;EAAEC,iBAAiB;EAAEC;AAAW,CAAC,EAAE;EAAAC,GAAA;EACrFjF,YAAY,CAAC;IACXkF,KAAK,EAAGnC,CAAC,IAAK;MACZ,IAAI,CAAC8B,SAAS,EAAE;MAEhB,MAAM;QAAElC,GAAG;QAAED;MAAI,CAAC,GAAGK,CAAC,CAACoC,MAAM;MAE7B,IAAI,CAACL,cAAc,EAAE;QACnB;QACAC,iBAAiB,CAAC;UAAEpC,GAAG;UAAED;QAAI,CAAC,CAAC;MACjC,CAAC,MAAM;QACL;QACA,MAAM0C,WAAW,GAAG;UAAEzC,GAAG;UAAED;QAAI,CAAC;QAChCsC,UAAU,CAACF,cAAc,EAAEM,WAAW,CAAC;;QAEvC;MACF;IACF;EACF,CAAC,CAAC;EAEF,OAAO,IAAI;AACb;AAACH,GAAA,CArBQL,eAAe;EAAA,QACtB5E,YAAY;AAAA;AAAAqF,GAAA,GADLT,eAAe;AAuBxB,MAAMU,eAAe,GAAGA,CAAA,KAAM;EAAAC,GAAA;EAC5B,MAAM;IAAEC,SAAS;IAAEC,cAAc;IAAEC,SAAS;IAAEC,cAAc;IAAEX;EAAW,CAAC,GAAGxF,UAAU,CAACS,eAAe,CAAC;EACxG,MAAM;IAAE6D;EAAK,CAAC,GAAGtE,UAAU,CAACU,WAAW,CAAC;EACxC;EACA,MAAM;IACJ0F,eAAe;IACfC,aAAa;IACbC,WAAW;IACXC,QAAQ;IACRC,WAAW;IACXC;EACF,CAAC,GAAGzG,UAAU,CAACW,WAAW,CAAC;EAE3B,MAAM,CAAC+F,iBAAiB,EAAEC,oBAAoB,CAAC,GAAG5G,QAAQ,CAAC,EAAE,CAAC;EAC9D,MAAM,CAAC6G,SAAS,EAAEC,YAAY,CAAC,GAAG9G,QAAQ,CAAC,IAAI,CAAC;EAChD,MAAM,CAAC+G,WAAW,EAAEC,cAAc,CAAC,GAAGhH,QAAQ,CAAC,IAAIiH,IAAI,CAAC,CAAC,CAAC;EAC1D,MAAM,CAACC,oBAAoB,EAAEC,uBAAuB,CAAC,GAAGnH,QAAQ,CAAC,EAAE,CAAC;EACpE,MAAM,CAACsF,SAAS,EAAE8B,YAAY,CAAC,GAAGpH,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAM,CAACuF,cAAc,EAAEC,iBAAiB,CAAC,GAAGxF,QAAQ,CAAC,IAAI,CAAC;EAC1D,MAAM,CAACqH,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGtH,QAAQ,CAAC,KAAK,CAAC;EACjE,MAAMuH,MAAM,GAAGrH,MAAM,CAAC,IAAI,CAAC;;EAE3B;EACA,MAAMsH,iBAAiB,GAAIC,MAAM,IAAK;IACpC,IAAIA,MAAM,KAAKlD,IAAI,CAACmD,EAAE,EAAE;MACtB;MACA;IACF;IAEArB,eAAe,CAACoB,MAAM,CAAC,CACpBE,IAAI,CAAEC,QAAQ,IAAK;MAClBrF,OAAO,CAACC,GAAG,CAAC,iCAAiC,EAAEoF,QAAQ,CAAC;IAC1D,CAAC,CAAC,CACDC,KAAK,CAAEpE,KAAK,IAAK;MAChBlB,OAAO,CAACkB,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;IACtD,CAAC,CAAC;EACN,CAAC;;EAED;EACA1D,SAAS,CAAC,MAAM;IACd,IAAIwE,IAAI,IAAImC,gBAAgB,EAAE;MAC5BA,gBAAgB,CAAC,CAAC;IACpB;EACF,CAAC,EAAE,CAACnC,IAAI,EAAEmC,gBAAgB,CAAC,CAAC;;EAE9B;EACA3G,SAAS,CAAC,MAAM;IACd,IAAI,CAACoG,SAAS,EAAE;MACd5D,OAAO,CAACC,GAAG,CAAC,sCAAsC,CAAC;MACnD2E,uBAAuB,CAAC,EAAE,CAAC;MAC3B;IACF;IAEA5E,OAAO,CAACC,GAAG,CAAC,oBAAoB2D,SAAS,CAACzD,MAAM,6BAA6B,CAAC;IAE9E,IAAI;MACF;MACA,MAAMoF,MAAM,GAAG3B,SAAS,CAAClD,GAAG,CAAC,CAAC0B,IAAI,EAAEoD,KAAK,KAAK;QAC5C;QACA,IAAI,CAACpD,IAAI,CAACqD,KAAK,EAAE;UACfzF,OAAO,CAACC,GAAG,CAAC,cAAcuF,KAAK,yBAAyB,EAAEpD,IAAI,CAAC;UAC/D;UACA,IAAIA,IAAI,CAACsD,SAAS,EAAE;YAClB1F,OAAO,CAACC,GAAG,CAAC,cAAcuF,KAAK,iCAAiC,CAAC;YACjEpD,IAAI,CAACqD,KAAK,GAAGrD,IAAI,CAACsD,SAAS;UAC7B,CAAC,MAAM;YACL1F,OAAO,CAACC,GAAG,CAAC,cAAcuF,KAAK,2BAA2B,CAAC;YAC3D,OAAO,IAAI;UACb;QACF;QAEA,MAAMnD,WAAW,GAAGvC,cAAc,CAACsC,IAAI,CAACqD,KAAK,CAAC;;QAE9C;QACA,IAAIpD,WAAW,CAAClC,MAAM,KAAK,CAAC,EAAE;UAC5BH,OAAO,CAACC,GAAG,CAAC,cAAcuF,KAAK,KAAKpD,IAAI,CAAC+C,EAAE,uBAAuB,CAAC;UACnE,OAAO,IAAI;QACb;QAEAnF,OAAO,CAACC,GAAG,CAAC,cAAcuF,KAAK,KAAKpD,IAAI,CAAC+C,EAAE,0BAA0B9C,WAAW,CAAClC,MAAM,SAAS,CAAC;;QAEjG;QACA,OAAO;UACL,GAAGiC,IAAI;UACPC;QACF,CAAC;MACH,CAAC,CAAC,CAACd,MAAM,CAACC,OAAO,CAAC,CAAC,CAAC;;MAEpBxB,OAAO,CAACC,GAAG,CAAC,iBAAiBsF,MAAM,CAACpF,MAAM,+BAA+B,CAAC;MAC1EyE,uBAAuB,CAACW,MAAM,CAAC;;MAE/B;MACA,IAAI3B,SAAS,CAACzD,MAAM,GAAG,CAAC,IAAIoF,MAAM,CAACpF,MAAM,KAAK,CAAC,EAAE;QAC/CH,OAAO,CAACqB,IAAI,CAAC,kCAAkC,EAAEuC,SAAS,CAAC;MAC7D;IACF,CAAC,CAAC,OAAO1C,KAAK,EAAE;MACdlB,OAAO,CAACkB,KAAK,CAAC,+BAA+B,EAAEA,KAAK,CAAC;MACrD0D,uBAAuB,CAAC,EAAE,CAAC;IAC7B;EACF,CAAC,EAAE,CAAChB,SAAS,CAAC,CAAC;EAEb,MAAM+B,eAAe,GAAGA,CAAA,KAAM;IAC5Bd,YAAY,CAAC,CAAC9B,SAAS,CAAC;IACxB,IAAIA,SAAS,EAAE;MACb;MACAE,iBAAiB,CAAC,IAAI,CAAC;IACzB;EACF,CAAC;EAED,MAAM2C,gBAAgB,GAAG,MAAAA,CAAOC,MAAM,EAAEvC,WAAW,KAAK;IACtD,IAAI;MACFtD,OAAO,CAACC,GAAG,CAAC,0BAA0B,EAAE4F,MAAM,EAAE,IAAI,EAAEvC,WAAW,CAAC;;MAElE;MACAiB,YAAY,CAAC,IAAI,CAAC;;MAElB;MACA,MAAMuB,MAAM,GAAG,MAAM5C,UAAU,CAAC2C,MAAM,EAAEvC,WAAW,CAAC;MAEpDtD,OAAO,CAACC,GAAG,CAAC,kCAAkC,EAAE6F,MAAM,CAAC;;MAEvD;MACA,MAAMjC,cAAc,CAAC,CAAC;;MAEtB;MACAY,cAAc,CAAC,IAAIC,IAAI,CAAC,CAAC,CAAC;;MAE1B;MACAG,YAAY,CAAC,KAAK,CAAC;MACnB5B,iBAAiB,CAAC,IAAI,CAAC;IACzB,CAAC,CAAC,OAAO/B,KAAK,EAAE;MACdlB,OAAO,CAACkB,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;MAClD;MACA6E,KAAK,CAAC,0BAA0B7E,KAAK,CAAC8E,OAAO,EAAE,CAAC;IAClD,CAAC,SAAS;MACRzB,YAAY,CAAC,KAAK,CAAC;IACrB;EACF,CAAC;EAED,MAAM0B,UAAU,GAAIC,IAAI,IAAK;IAC3B,IAAI,EAAEA,IAAI,YAAYxB,IAAI,CAAC,EAAE;MAC3B,IAAI;QACFwB,IAAI,GAAG,IAAIxB,IAAI,CAACwB,IAAI,CAAC;MACvB,CAAC,CAAC,OAAOjF,CAAC,EAAE;QACV,OAAO,SAAS;MAClB;IACF;IACA,OAAOiF,IAAI,CAACC,kBAAkB,CAAC,CAAC;EAClC,CAAC;EAED,IAAI7B,SAAS,IAAIF,iBAAiB,CAACjE,MAAM,KAAK,CAAC,IAAIwE,oBAAoB,CAACxE,MAAM,KAAK,CAAC,EAAE;IACpF,oBAAOpB,OAAA;MAAKa,SAAS,EAAC,aAAa;MAAAwG,QAAA,EAAC;IAAc;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC;EAC1D;;EAEA;EACA,IAAIC,SAAS,GAAG,CAAC;IAAEC,SAAS,GAAG,CAAC;EAEhC,IAAItC,iBAAiB,CAACjE,MAAM,GAAG,CAAC,EAAE;IAChCsG,SAAS,GAAGrC,iBAAiB,CAACuC,MAAM,CAAC,CAACC,GAAG,EAAEC,CAAC,KAAKD,GAAG,GAAG7F,UAAU,CAAC8F,CAAC,CAAC5E,QAAQ,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,GAAGmC,iBAAiB,CAACjE,MAAM;IACjHuG,SAAS,GAAGtC,iBAAiB,CAACuC,MAAM,CAAC,CAACC,GAAG,EAAEC,CAAC,KAAKD,GAAG,GAAG7F,UAAU,CAAC8F,CAAC,CAAC3E,SAAS,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,GAAGkC,iBAAiB,CAACjE,MAAM;EACpH,CAAC,MAAM;IACL;IACAsG,SAAS,GAAG,CAAC;IACbC,SAAS,GAAG,CAAC;EACf;EAEA,oBACE3H,OAAA;IAAKa,SAAS,EAAC,eAAe;IAAAwG,QAAA,gBAC7BrH,OAAA;MAAKa,SAAS,EAAC,YAAY;MAAAwG,QAAA,gBAC1BrH,OAAA;QAAAqH,QAAA,EAAI;MAAa;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACtBzH,OAAA;QAAKa,SAAS,EAAC,cAAc;QAAAwG,QAAA,gBAC3BrH,OAAA;UAAKa,SAAS,EAAC,uBAAuB;UAAAwG,QAAA,gBACpCrH,OAAA,CAACN,kBAAkB;YACjBqI,iBAAiB,EAAE/C,aAAa,GAAGA,aAAa,CAAC5D,MAAM,GAAG,CAAE;YAC5D4G,OAAO,EAAEA,CAAA,KAAMhC,oBAAoB,CAAC,CAACD,iBAAiB;UAAE;YAAAuB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACzD,CAAC,EAED1B,iBAAiB,iBAChB/F,OAAA,CAACR,kBAAkB;YAACyI,OAAO,EAAEA,CAAA,KAAMjC,oBAAoB,CAAC,KAAK;UAAE;YAAAsB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAClE;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACE,CAAC,eAENzH,OAAA;UACEa,SAAS,EAAE,gBAAgBmD,SAAS,GAAG,QAAQ,GAAG,EAAE,EAAG;UACvDgE,OAAO,EAAEpB,eAAgB;UAAAS,QAAA,EAExBrD,SAAS,GAAG,cAAc,GAAG;QAAc;UAAAsD,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACtC,CAAC,EAERzD,SAAS,IAAI,CAACC,cAAc,iBAC3BjE,OAAA;UAAKa,SAAS,EAAC,oBAAoB;UAAAwG,QAAA,EAAC;QAAkC;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK,CAC5E,EAEAzD,SAAS,IAAIC,cAAc,iBAC1BjE,OAAA;UAAKa,SAAS,EAAC,oBAAoB;UAAAwG,QAAA,EAAC;QAA+B;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK,CACzE,eAEDzH,OAAA;UAAMa,SAAS,EAAC,cAAc;UAAAwG,QAAA,GAAC,gBACf,EAACH,UAAU,CAACzB,WAAW,CAAC;QAAA;UAAA6B,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAClC,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACJ,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,eAEJzH,OAAA,CAACnB,YAAY;MACXqJ,MAAM,EAAE,CAACR,SAAS,EAAEC,SAAS,CAAE;MAC/BQ,IAAI,EAAE,CAAE;MACRC,KAAK,EAAE;QAAEC,MAAM,EAAE,OAAO;QAAEC,KAAK,EAAE;MAAO,CAAE;MAC1CC,GAAG,EAAEtC,MAAO;MAAAoB,QAAA,gBAEZrH,OAAA,CAAClB,SAAS;QACR0J,WAAW,EAAC,yFAAyF;QACrGC,GAAG,EAAC;MAAoD;QAAAnB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACzD,CAAC,eAGFzH,OAAA,CAAC+D,eAAe;QACdC,SAAS,EAAEA,SAAU;QACrBC,cAAc,EAAEA,cAAe;QAC/BC,iBAAiB,EAAEA,iBAAkB;QACrCC,UAAU,EAAE0C;MAAiB;QAAAS,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC9B,CAAC,EAGDpC,iBAAiB,CAAC1D,GAAG,CAACmG,CAAC,iBACtB9H,OAAA,CAACjB,MAAM;QAEL2J,QAAQ,EAAE,CAAC1G,UAAU,CAAC8F,CAAC,CAAC5E,QAAQ,CAAC,EAAElB,UAAU,CAAC8F,CAAC,CAAC3E,SAAS,CAAC,CAAE;QAC5DxD,IAAI,EAAEe,gBAAgB,CAACoH,CAAC,CAAC1B,EAAE,MAAKnD,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEmD,EAAE,IAAG,SAAS,GAAG,SAAS,CAAE;QAAAiB,QAAA,eAElErH,OAAA,CAAChB,KAAK;UAAAqI,QAAA,eACJrH,OAAA;YAAKa,SAAS,EAAC,YAAY;YAAAwG,QAAA,gBACzBrH,OAAA;cAAAqH,QAAA,EAAKS,CAAC,CAACa;YAAQ;cAAArB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC,eACrBzH,OAAA;cAAKa,SAAS,EAAC,aAAa;cAAAwG,QAAA,gBAC1BrH,OAAA;gBAAMa,SAAS,EAAC;cAAY;gBAAAyG,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO,CAAC,UAEtC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC,eACNzH,OAAA;cAAKa,SAAS,EAAC,eAAe;cAAAwG,QAAA,GAAC,eAChB,EAACrF,UAAU,CAAC8F,CAAC,CAAC5E,QAAQ,CAAC,CAAC0F,OAAO,CAAC,CAAC,CAAC,EAAC,IAAE,EAAC5G,UAAU,CAAC8F,CAAC,CAAC3E,SAAS,CAAC,CAACyF,OAAO,CAAC,CAAC,CAAC;YAAA;cAAAtB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAClF,CAAC,eACNzH,OAAA;cAAKa,SAAS,EAAC,kBAAkB;cAAAwG,QAAA,GAAC,eACnB,EAACH,UAAU,CAACY,CAAC,CAACe,WAAW,CAAC;YAAA;cAAAvB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACpC,CAAC,EACLK,CAAC,CAAC1B,EAAE,MAAKnD,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEmD,EAAE,iBAChBpG,OAAA;cAAKa,SAAS,EAAC,kBAAkB;cAAAwG,QAAA,EAAC;YAAW;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC,gBAEnDzH,OAAA;cAAKa,SAAS,EAAC,uBAAuB;cAAAwG,QAAA,eACpCrH,OAAA;gBACEa,SAAS,EAAC,qBAAqB;gBAC/BmH,OAAO,EAAEA,CAAA,KAAM9B,iBAAiB,CAAC4B,CAAC,CAAC1B,EAAE,CAAE;gBAAAiB,QAAA,GACxC,YACW,EAACS,CAAC,CAACa,QAAQ;cAAA;gBAAArB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACf;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACN,CACN;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACE;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACD;MAAC,GA9BH,QAAQK,CAAC,CAAC1B,EAAE,EAAE;QAAAkB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OA+Bb,CACT,CAAC,EAGDzD,SAAS,IAAIC,cAAc,iBAC1BjE,OAAA,CAACjB,MAAM;QACL2J,QAAQ,EAAE,CAACzE,cAAc,CAACnC,GAAG,EAAEmC,cAAc,CAACpC,GAAG,CAAE;QACnDlC,IAAI,EAAEe,gBAAgB,CAAC,SAAS,CAAE;QAAA2G,QAAA,eAElCrH,OAAA,CAAChB,KAAK;UAAAqI,QAAA,EAAC;QAAc;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACvB,CACT,EAGA7B,oBAAoB,CAACjE,GAAG,CAAC,CAAC0B,IAAI,EAAEyF,GAAG,kBAClC9I,OAAA,CAACf,QAAQ;QAEP8J,SAAS,EAAE1F,IAAI,CAACC,WAAY;QAC5B3C,KAAK,EAAE0C,IAAI,CAAC2F,OAAO,MAAK/F,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEmD,EAAE,IAAG,SAAS,GAAG,SAAU;QACzD6C,MAAM,EAAE,CAAE;QACVC,OAAO,EAAE,GAAI;QAAA7B,QAAA,eAEbrH,OAAA,CAAChB,KAAK;UAAAqI,QAAA,eACJrH,OAAA;YAAKa,SAAS,EAAC,YAAY;YAAAwG,QAAA,gBACzBrH,OAAA;cAAAqH,QAAA,EAAI;YAAiB;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eAC1BzH,OAAA;cAAAqH,QAAA,gBAAGrH,OAAA;gBAAAqH,QAAA,EAAQ;cAAK;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,KAAC,EAACpE,IAAI,CAACsF,QAAQ,IAAI,SAAS;YAAA;cAAArB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eAC1DzH,OAAA;cAAAqH,QAAA,gBAAGrH,OAAA;gBAAAqH,QAAA,EAAQ;cAAQ;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,KAAC,EAACP,UAAU,CAAC7D,IAAI,CAAC8F,UAAU,CAAC;YAAA;cAAA7B,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,EAC7DpE,IAAI,CAACC,WAAW,CAAClC,MAAM,GAAG,CAAC,iBAC1BpB,OAAA,CAAAE,SAAA;cAAAmH,QAAA,gBACErH,OAAA;gBAAAqH,QAAA,gBAAGrH,OAAA;kBAAAqH,QAAA,EAAQ;gBAAK;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAQ,CAAC,KAAC,EAACpE,IAAI,CAACC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACsF,OAAO,CAAC,CAAC,CAAC,EAAC,IAAE,EAACvF,IAAI,CAACC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACsF,OAAO,CAAC,CAAC,CAAC;cAAA;gBAAAtB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,eACtGzH,OAAA;gBAAAqH,QAAA,gBAAGrH,OAAA;kBAAAqH,QAAA,EAAQ;gBAAG;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAQ,CAAC,KAAC,EAACpE,IAAI,CAACC,WAAW,CAACD,IAAI,CAACC,WAAW,CAAClC,MAAM,GAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACwH,OAAO,CAAC,CAAC,CAAC,EAAC,IAAE,EAACvF,IAAI,CAACC,WAAW,CAACD,IAAI,CAACC,WAAW,CAAClC,MAAM,GAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACwH,OAAO,CAAC,CAAC,CAAC;cAAA;gBAAAtB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,eACpJzH,OAAA;gBAAAqH,QAAA,gBAAGrH,OAAA;kBAAAqH,QAAA,EAAQ;gBAAO;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAQ,CAAC,KAAC,EAACpE,IAAI,CAACC,WAAW,CAAClC,MAAM;cAAA;gBAAAkG,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC;YAAA,eACzD,CACH;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACE;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACD;MAAC,GAnBH,QAAQpE,IAAI,CAAC+C,EAAE,IAAI0C,GAAG,EAAE;QAAAxB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAoBrB,CACX,CAAC,eAGFzH,OAAA,CAAC4C,gBAAgB;QACfC,KAAK,EAAEwC,iBAAkB;QACzBvC,KAAK,EAAE8C;MAAqB;QAAA0B,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC7B,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACU,CAAC,eAEfzH,OAAA;MAAKa,SAAS,EAAC,YAAY;MAAAwG,QAAA,gBACzBrH,OAAA;QAAAqH,QAAA,EAAI;MAAU;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACnBzH,OAAA;QAAKa,SAAS,EAAC,cAAc;QAAAwG,QAAA,gBAC3BrH,OAAA;UAAKa,SAAS,EAAC,aAAa;UAAAwG,QAAA,gBAC1BrH,OAAA;YAAKa,SAAS,EAAC,eAAe;YAACuH,KAAK,EAAE;cAAEgB,eAAe,EAAE;YAAU;UAAE;YAAA9B,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAC5EzH,OAAA;YAAAqH,QAAA,EAAM;UAAa;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACvB,CAAC,eACNzH,OAAA;UAAKa,SAAS,EAAC,aAAa;UAAAwG,QAAA,gBAC1BrH,OAAA;YAAKa,SAAS,EAAC,eAAe;YAACuH,KAAK,EAAE;cAAEgB,eAAe,EAAE;YAAU;UAAE;YAAA9B,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAC5EzH,OAAA;YAAAqH,QAAA,EAAM;UAAW;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACrB,CAAC,eACNzH,OAAA;UAAKa,SAAS,EAAC,aAAa;UAAAwG,QAAA,gBAC1BrH,OAAA;YAAKa,SAAS,EAAC,aAAa;YAACuH,KAAK,EAAE;cAAEgB,eAAe,EAAE;YAAU;UAAE;YAAA9B,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAC1EzH,OAAA;YAAAqH,QAAA,EAAM;UAAU;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACpB,CAAC,eACNzH,OAAA;UAAKa,SAAS,EAAC,aAAa;UAAAwG,QAAA,gBAC1BrH,OAAA;YAAKa,SAAS,EAAC,aAAa;YAACuH,KAAK,EAAE;cAAEgB,eAAe,EAAE;YAAU;UAAE;YAAA9B,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAC1EzH,OAAA;YAAAqH,QAAA,EAAM;UAAkB;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC5B,CAAC,EACLzD,SAAS,iBACRhE,OAAA;UAAKa,SAAS,EAAC,aAAa;UAAAwG,QAAA,gBAC1BrH,OAAA;YAAKa,SAAS,EAAC,eAAe;YAACuH,KAAK,EAAE;cAAEgB,eAAe,EAAE;YAAU;UAAE;YAAA9B,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAC5EzH,OAAA;YAAAqH,QAAA,EAAM;UAAuB;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACjC,CACN;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACE,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,eAGNzH,OAAA;MAAKa,SAAS,EAAC,gBAAgB;MAAAwG,QAAA,gBAC7BrH,OAAA;QAAAqH,QAAA,EAAI;MAAU;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACnBzH,OAAA;QAAKa,SAAS,EAAC,WAAW;QAAAwG,QAAA,gBACxBrH,OAAA;UAAKa,SAAS,EAAC,WAAW;UAAAwG,QAAA,gBACxBrH,OAAA;YAAAqH,QAAA,EAAQ;UAAa;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,KAAC,EAACpC,iBAAiB,CAACjE,MAAM;QAAA;UAAAkG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACrD,CAAC,eACNzH,OAAA;UAAKa,SAAS,EAAC,WAAW;UAAAwG,QAAA,gBACxBrH,OAAA;YAAAqH,QAAA,EAAQ;UAAa;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,KAAC,EAAC7B,oBAAoB,CAACxE,MAAM;QAAA;UAAAkG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACxD,CAAC,eACNzH,OAAA;UAAKa,SAAS,EAAC,WAAW;UAAAwG,QAAA,gBACxBrH,OAAA;YAAAqH,QAAA,EAAQ;UAAa;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,KAAC,EAACP,UAAU,CAACzB,WAAW,CAAC;QAAA;UAAA6B,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACpD,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,eAGNzH,OAAA;QAAKa,SAAS,EAAC,cAAc;QAAAwG,QAAA,gBAC3BrH,OAAA;UAAAqH,QAAA,gBACErH,OAAA,CAACH,eAAe;YAACF,IAAI,EAAEG;UAAW;YAAAwH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,iBACvC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eACLzH,OAAA;UAAKa,SAAS,EAAC,YAAY;UAAAwG,QAAA,EACxBlC,WAAW,IAAIA,WAAW,CAAC/D,MAAM,GAAG,CAAC,GACpC+D,WAAW,CAACxD,GAAG,CAAC0H,IAAI,iBAClBrJ,OAAA;YAEEa,SAAS,EAAC,WAAW;YACrBmH,OAAO,EAAEA,CAAA,KAAM9C,QAAQ,CAACmE,IAAI,CAACjD,EAAE,CAAE;YAAAiB,QAAA,gBAEjCrH,OAAA;cAAKa,SAAS,EAAC,WAAW;cAAAwG,QAAA,EACvBgC,IAAI,CAACC,iBAAiB,IAAID,IAAI,CAACC,iBAAiB,CAAClI,MAAM,GAAG,CAAC,GACxDiI,IAAI,CAACC,iBAAiB,CAAC,CAAC,CAAC,CAACX,QAAQ,GAClC;YAAc;cAAArB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACf,CAAC,EACL4B,IAAI,CAACE,WAAW,GAAG,CAAC,iBACnBvJ,OAAA;cAAMa,SAAS,EAAC,cAAc;cAAAwG,QAAA,EAAEgC,IAAI,CAACE;YAAW;cAAAjC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CACxD;UAAA,GAXI4B,IAAI,CAACjD,EAAE;YAAAkB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAYT,CACN,CAAC,gBAEFzH,OAAA;YAAKa,SAAS,EAAC,UAAU;YAAAwG,QAAA,EAAC;UAAe;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK;QAC/C;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,EAEL7B,oBAAoB,CAACxE,MAAM,GAAG,CAAC,iBAC9BpB,OAAA;QAAKa,SAAS,EAAC,cAAc;QAAAwG,QAAA,gBAC3BrH,OAAA;UAAAqH,QAAA,EAAI;QAAY;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eACrBzH,OAAA;UAAKa,SAAS,EAAC,YAAY;UAAAwG,QAAA,EACxBzB,oBAAoB,CAAC4D,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC7H,GAAG,CAAC,CAAC0B,IAAI,EAAEyF,GAAG,kBAC9C9I,OAAA;YAAea,SAAS,EAAC,WAAW;YAAAwG,QAAA,gBAClCrH,OAAA;cAAKa,SAAS,EAAC,aAAa;cAAAwG,QAAA,gBAC1BrH,OAAA;gBAAAqH,QAAA,EAAShE,IAAI,CAACsF,QAAQ,IAAI;cAAc;gBAAArB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAS,CAAC,eAClDzH,OAAA;gBAAAqH,QAAA,EAAOH,UAAU,CAAC7D,IAAI,CAAC8F,UAAU;cAAC;gBAAA7B,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACvC,CAAC,eACNzH,OAAA;cAAKa,SAAS,EAAC,cAAc;cAAAwG,QAAA,EAC1BhE,IAAI,CAACC,WAAW,CAAClC,MAAM,GAAG,CAAC,iBAC1BpB,OAAA,CAAAE,SAAA;gBAAAmH,QAAA,gBACErH,OAAA;kBAAAqH,QAAA,GAAO,QACC,EAAChE,IAAI,CAACC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACsF,OAAO,CAAC,CAAC,CAAC,EAAC,IAAE,EAACvF,IAAI,CAACC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACsF,OAAO,CAAC,CAAC,CAAC;gBAAA;kBAAAtB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACxE,CAAC,eACRzH,OAAA;kBAAAqH,QAAA,GAAO,MACD,EAAChE,IAAI,CAACC,WAAW,CAACD,IAAI,CAACC,WAAW,CAAClC,MAAM,GAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACwH,OAAO,CAAC,CAAC,CAAC,EAAC,IAAE,EAACvF,IAAI,CAACC,WAAW,CAACD,IAAI,CAACC,WAAW,CAAClC,MAAM,GAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACwH,OAAO,CAAC,CAAC,CAAC;gBAAA;kBAAAtB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACtH,CAAC,eACRzH,OAAA;kBAAAqH,QAAA,GAAO,gBACS,EAAChE,IAAI,CAACC,WAAW,CAAClC,MAAM;gBAAA;kBAAAkG,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACjC,CAAC;cAAA,eACR;YACH;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACE,CAAC;UAAA,GAnBEqB,GAAG;YAAAxB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAoBR,CACN;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CACN;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC,EAGLxC,WAAW,iBAAIjF,OAAA,CAACT,UAAU;MAAA+H,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAC3B,CAAC;AAEV,CAAC;AAAC/C,GAAA,CA1ZID,eAAe;AAAAgF,GAAA,GAAfhF,eAAe;AA4ZrB,eAAeA,eAAe;AAAC,IAAAX,EAAA,EAAAU,GAAA,EAAAiF,GAAA;AAAAC,YAAA,CAAA5F,EAAA;AAAA4F,YAAA,CAAAlF,GAAA;AAAAkF,YAAA,CAAAD,GAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}